<!doctype html>
<html lang="en">
<head>
    <title>Code coverage report for src/sputils.termstore.js</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../prettify.css">
    <link rel="stylesheet" href="../base.css">
    <style type='text/css'>
        div.coverage-summary .sorter {
            background-image: url(../sort-arrow-sprite.png);
        }
    </style>
</head>
<body>
<div class="header low">
    <h1>Code coverage report for <span class="entity">src/sputils.termstore.js</span></h1>
    <h2>
        Statements: <span class="metric">21.79% <small>(17 / 78)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Branches: <span class="metric">0% <small>(0 / 10)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Functions: <span class="metric">3.57% <small>(1 / 28)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Lines: <span class="metric">21.79% <small>(17 / 78)</small></span> &nbsp;&nbsp;&nbsp;&nbsp;
        Ignored: <span class="metric"><span class="ignore-none">none</span></span> &nbsp;&nbsp;&nbsp;&nbsp;
    </h2>
    <div class="path"><a href="../index.html">All files</a> &#187; <a href="index.html">src/</a> &#187; sputils.termstore.js</div>
</div>
<div class="body">
<pre><table class="coverage">
<tr><td class="line-count">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239</td><td class="line-coverage"><span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-no">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-yes">1</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span>
<span class="cline-any cline-neutral">&nbsp;</span></td><td class="text"><pre class="prettyprint lang-js">(function () {
  // a function that creates common properties on a Node-like
  // object. A Node-like object has children, and sortedChildren
  var initNode = <span class="fstat-no" title="function not covered" >function (n) {</span>
    // indexed by name, no guaranteed order
<span class="cstat-no" title="statement not covered" >    n.children = {};</span>
    // indexed by order (by custom sort order if defined)
<span class="cstat-no" title="statement not covered" >    n.sortedChildren = [];</span>
  };
&nbsp;
  var TermsTree = <span class="fstat-no" title="function not covered" >function (termSet) {</span>
<span class="cstat-no" title="statement not covered" >    this.termSet = termSet;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    initNode(this);</span>
  };
&nbsp;
  TermsTree.prototype = {
    getSortOrder: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >      return this.termSet.get_customSortOrder();</span>
    }
  };
&nbsp;
  // A data structure wrapping SP.Term objects
  // with convenience functions and a children object
  var Node = <span class="fstat-no" title="function not covered" >function (term) {</span>
<span class="cstat-no" title="statement not covered" >    this.term = term;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    initNode(this);</span>
  };
&nbsp;
  Node.prototype = {
    getName: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >      return this.term.get_name();</span>
    },
&nbsp;
    getUrl: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >      return this.term.get_localCustomProperties()</span>
        ._Sys_Nav_SimpleLinkUrl;
    },
&nbsp;
    getSortOrder: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >      return this.term.get_customSortOrder();</span>
    },
&nbsp;
    getIsRoot: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >      return this.term.get_isRoot();</span>
    },
&nbsp;
    getGuid: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >      return this.term.get_id();</span>
    },
&nbsp;
    getLocalCustomProperty: <span class="fstat-no" title="function not covered" >function (propertyName) {</span>
<span class="cstat-no" title="statement not covered" >      return this.term.get_localCustomProperties()[propertyName];</span>
    },
&nbsp;
    toString: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >      return this.getName();</span>
    },
    toLocaleString: <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >      return this.getName();</span>
    }
  };
&nbsp;
  var generateList = <span class="fstat-no" title="function not covered" >function (terms) {</span>
<span class="cstat-no" title="statement not covered" >    var termsEnumerator = terms.getEnumerator(),</span>
        result = [];
&nbsp;
<span class="cstat-no" title="statement not covered" >    while (termsEnumerator.moveNext()) {</span>
<span class="cstat-no" title="statement not covered" >      result.push(termsEnumerator.get_current());</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return result;</span>
  };
&nbsp;
  // Generates the link tree by going through them one
  // by one and putting them in the correct hierarchy
  var generateTree = <span class="fstat-no" title="function not covered" >function (terms) {</span>
    // Get the hidden _termSet property
    // we put on the original terms object.
<span class="cstat-no" title="statement not covered" >    var termSet = terms._termSet;</span>
<span class="cstat-no" title="statement not covered" >    var mainTree = new TermsTree(termSet);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    var populateTree = <span class="fstat-no" title="function not covered" >function (tree, term, path) {</span></span>
<span class="cstat-no" title="statement not covered" >      var name = path[0];</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >      if (path.length === 1) {</span>
<span class="cstat-no" title="statement not covered" >        if (tree[name]) {</span>
<span class="cstat-no" title="statement not covered" >          tree[name].term = term;</span>
        } else {
<span class="cstat-no" title="statement not covered" >          tree[name] = new Node(term);</span>
        }
      } else {
<span class="cstat-no" title="statement not covered" >        if (!tree[name]) {</span>
<span class="cstat-no" title="statement not covered" >          tree[name] = new Node();</span>
        }
&nbsp;
<span class="cstat-no" title="statement not covered" >        populateTree(tree[name].children, term, path.slice(1));</span>
      }
    };
&nbsp;
    // Reuse generateList to turn the terms
    // object into a list of terms.
<span class="cstat-no" title="statement not covered" >    generateList(terms).forEach(<span class="fstat-no" title="function not covered" >function (currentTerm) {</span></span>
<span class="cstat-no" title="statement not covered" >      populateTree(mainTree.children, currentTerm, currentTerm.get_pathOfTerm().split(';'));</span>
    });
&nbsp;
<span class="cstat-no" title="statement not covered" >    return mainTree;</span>
  };
&nbsp;
  var getDefaultTermStore = <span class="fstat-no" title="function not covered" >function (context) {</span>
<span class="cstat-no" title="statement not covered" >    var session = SP.Taxonomy.TaxonomySession.getTaxonomySession(context);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    return session.getDefaultSiteCollectionTermStore();</span>
  };
&nbsp;
  // Returns a promise which resolves when SP Taxonomy is loaded
  var withTaxonomy = <span class="fstat-no" title="function not covered" >function () {</span>
<span class="cstat-no" title="statement not covered" >    return sputils.helpers.withSharePointDependencies([{</span>
      file: 'sp.taxonomy.js',
      namespace: 'SP.Taxonomy'
    }]);
  };
&nbsp;
  var sortTerms = <span class="fstat-no" title="function not covered" >function (parent) {</span>
<span class="cstat-no" title="statement not covered" >    var sortOrder = parent.getSortOrder();</span>
<span class="fstat-no" title="function not covered" >    function accordingToSortOrder(childA, childB) {</span>
<span class="cstat-no" title="statement not covered" >      var getGuid = <span class="fstat-no" title="function not covered" >function (x) {</span></span>
<span class="cstat-no" title="statement not covered" >        return x.getGuid().toString();</span>
      };
<span class="cstat-no" title="statement not covered" >      var a = sortOrder.indexOf(getGuid(childA)),</span>
          b = sortOrder.indexOf(getGuid(childB));
&nbsp;
      // numerically, ascending
<span class="cstat-no" title="statement not covered" >      return a - b;</span>
      // numerically, descending
      // return b - a;
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    var secondEl = fjs.pluck(1);</span>
<span class="cstat-no" title="statement not covered" >    var cArr = secondEl(fjs.toArray(parent.children));</span>
<span class="cstat-no" title="statement not covered" >    parent.sortedChildren = cArr;</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (sortOrder) {</span>
      // Sort order is a string of guids
      // separated by ":".
<span class="cstat-no" title="statement not covered" >      sortOrder = sortOrder.split(':');</span>
&nbsp;
      // Replace children with an array sorted
      // according to the sortOrder.
<span class="cstat-no" title="statement not covered" >      cArr.sort(accordingToSortOrder);</span>
    } else {
      // sortBy with no second parameter
      // sorts on identity (just compares the values)
      // lexicographically, i.e. "alphabetically".
<span class="cstat-no" title="statement not covered" >      cArr.sort();</span>
    }
  };
&nbsp;
  // Takes a tree and recursively
  // sorts all levels
  var sortTree = <span class="fstat-no" title="function not covered" >function (tree) {</span>
<span class="cstat-no" title="statement not covered" >    sortTerms(tree);</span>
&nbsp;
<span class="cstat-no" title="statement not covered" >    if (tree.sortedChildren.length) {</span>
<span class="cstat-no" title="statement not covered" >      fjs.each(sortTree, tree.sortedChildren);</span>
    }
&nbsp;
<span class="cstat-no" title="statement not covered" >    return tree;</span>
  };
&nbsp;
  /**
  * Returns a promise which resolves with
  * an object containing all the terms
  * corresponding to the given termset id.
  * @function sputils.termstore.getTerms
  * @param {string} id a termset guid
  * @returns {object}
  */
  var getTerms = <span class="fstat-no" title="function not covered" >function (id) {</span>
<span class="cstat-no" title="statement not covered" >    return withTaxonomy().then(<span class="fstat-no" title="function not covered" >function () {</span></span>
<span class="cstat-no" title="statement not covered" >      var context = SP.ClientContext.get_current(),</span>
          termStore = getDefaultTermStore(context),
          termSet = termStore.getTermSet(id),
          terms = termSet.getAllTerms();
&nbsp;
<span class="cstat-no" title="statement not covered" >      context.load(terms);</span>
<span class="cstat-no" title="statement not covered" >      context.load(termSet);</span>
<span class="cstat-no" title="statement not covered" >      return new Cctx(context).executeQuery()</span>
        .then(<span class="fstat-no" title="function not covered" >function () {</span>
          // Add the termSet on the terms
          // object so we can access it later.
<span class="cstat-no" title="statement not covered" >          terms._termSet = termSet;</span>
<span class="cstat-no" title="statement not covered" >          return terms;</span>
        });
    });
  };
&nbsp;
  /**
  * Returns a promise which resolves
  * to an array. Each element
  * is a taxonomy term object.
  * @function sputils.termstore.getTermsList
  * @param {string} id a termset guid
  * @returns {array}
  */
  var getTermsList = <span class="fstat-no" title="function not covered" >function (id) {</span>
<span class="cstat-no" title="statement not covered" >    return getTerms(id)</span>
      .then(generateList);
  };
&nbsp;
  /**
  * Returns a promise which resolves
  * to a tree object. Each node has
  * a children property which is sorted
  * according to customSortOrder.
  * @function sputils.termstore.getTermsTree
  * @param {string} id a termset guid
  * @returns {object}
  */
  var getTermsTree = <span class="fstat-no" title="function not covered" >function (id) {</span>
<span class="cstat-no" title="statement not covered" >    return getTerms(id)</span>
      // The terms are unordered and without
      // a useful way of interpreting the hierarchy,
      // so we turn them into a tree.
      .then(generateTree)
      // And then sorted according to customSortOrder
      .then(sortTree);
  };
&nbsp;
  /** @namespace */
  sputils.termstore = {
    getTerms: getTerms,
    getTermsList: getTermsList,
    getTermsTree: getTermsTree,
    withTaxonomy: withTaxonomy
  };
})();
&nbsp;</pre></td></tr>
</table></pre>

</div>
<div class="footer">
    <div class="meta">Generated by <a href="http://istanbul-js.org/" target="_blank">istanbul</a> at Wed Apr 27 2016 16:03:07 GMT+0200 (CEST)</div>
</div>
<script src="../prettify.js"></script>
<script>
window.onload = function () {
        if (typeof prettyPrint === 'function') {
            prettyPrint();
        }
};
</script>
<script src="../sorter.js"></script>
</body>
</html>
