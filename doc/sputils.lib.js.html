<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: sputils.lib.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: sputils.lib.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/** @namespace sputils.lib */

/**
 * `Cctx` is a usability wrapper for a SharePoint ClientContext
 * @example
 * new Cctx(sharepointClientContext)
 */
function Cctx(spClientContext) {
  this._cctx = spClientContext;
}

Cctx.prototype = {
  /**
   * wrapper around the clientContext.executeQueryAsync, that
   * returns a promise.
   * @returns {Promise&lt;Void>}
   */
  executeQuery: function () {
    var c = this._cctx;
    return new Promise(function (resolve, reject) {
      c.executeQueryAsync(resolve, function fail(cctx, failInfo) {
        var msg = [
          'ClientContext.executeQueryAsync failed',
          failInfo.get_message(),
          '',
          'CorrelationId:',
          failInfo.get_errorTraceCorrelationId()
        ].join('\n');
        var err = new Error(msg);
        reject(err);
      });
    });
  }
};

/**
* "taps" a function to produce a side effect
* but wrap it in an identity fn.
*
* @function sputils.lib.tap
**/
var tap = function (fn) {
  return function (value) {
    fn(value);
    return value;
  };
};


/**
* Get a value deeply from an object without crashing on nulls.
*
* This function is dynamic, so can be bound or just assigned to an
* object.
*
* Can be used to "index" arrays.
*
* @function sputils.lib.getval
* @param {string} subscript - the subscript string, i.e. 'a.b.c.prop'
* @param {Optional&lt;object>} root - the root object. Defaults to this.
* @returns {string} the value of the prop, if exists else undefined
* @example
* var obj = {a:{b:{c:{}}}}
* var c = sputils.lib.getval('a.b.c', obj);
* c === obj.a.b.c;
* var none = sputils.lib.getval('a.b.1.notHere', obj);
* none === void 0;
*
* // dynamic binding
* testObjects.getval = sputils.lib.getval;
* expect(testObjects.getval('a.b')).to.equal(testObjects.a.b);
*
* // any kind of property name is allowed, excepting period.
* var getval = sputils.lib.getval;
* var res = getval('a.b.d.2.long prop name', testObjects);
* expect(res).to.equal(testObjects.a.b.d[2]['long prop name']);
**/
var getval = function recur(subscript, root) {
  if (this === sputils.lib) {
    return recur.call(global, subscript, root);
  }
  root = (root || this) || global;

  // if subscript already is an array, just use it.
  var parts = subscript.constructor === ([]).constructor ?
    subscript : subscript.split('.');
  var nextProp = parts[0];
  var next = root[nextProp];
  if (next !== void 0) {
    if (parts.length > 1) {
      return recur(parts.slice(1), next);
    }

    return next;
  }

  return void 0;
};

sputils.lib = {
  getval: getval,
  tap: tap
};
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Namespaces</h3><ul><li><a href="sputils.conversion.html">conversion</a></li><li><a href="sputils.helpers.html">helpers</a></li><li><a href="sputils.lib.html">lib</a></li><li><a href="sputils.list.html">list</a></li><li><a href="sputils.list.files.html">files</a></li><li><a href="sputils.rest.html">rest</a></li><li><a href="sputils.search.html">search</a></li><li><a href="sputils.termstore.html">termstore</a></li><li><a href="sputils.thirdParty.html">thirdParty</a></li><li><a href="sputils.thirdParty.moment.html">moment</a></li><li><a href="sputils.thirdParty.moment.tz.html">tz</a></li><li><a href="sputils.ui.html">ui</a></li><li><a href="sputils.user.html">user</a></li></ul><h3>Global</h3><ul><li><a href="global.html#Cctx">Cctx</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.0</a> on Wed Apr 27 2016 23:43:49 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
