/* sputils 26-08-2015 */
function $_global_sputils(){"use strict";!function(a,b){a.sputils=a.sputils||{};var c=a.sputils;_spPageContextInfo=_spPageContextInfo||function(){throw Error("_spPageContextInfo not found")}();var d=function(){var a={},b="hardReturn;",c=function(b){if(a.isString(b)){var c=b.match(/(.*)\s*[=-]>\s*(.*)/);c.shift();var d=c.shift().replace(/^\s*|\s(?=\s)|\s*$|,/g,"").split(" "),e=c.shift();return c=(/\s*return\s+/.test(e)?"":"return ")+e,d.push(c),Function.apply({},d)}},d=function(a){return a.length>0?[].slice.call(a,0):[]};a.isFunction=function(a){return!!(a&&a.constructor&&a.call&&a.apply)},a.isObject=function(b){return a.isFunction(b)||!!b&&"object"==typeof b},a.isArray=function(a){return"[object Array]"===Object.prototype.toString.call(a)};var e=function(b){if(!a.isFunction(b)&&(b=c(b),!a.isFunction(b)))throw"fjs Error: Invalid function";return b};return a.curry=function(b){return b=e(b),function c(){var e=d(arguments);if(e.length===b.length)return b.apply(null,e);if(e.length>b.length){var f=b.apply(null,e);return a.fold(b,f,e.slice(b.length))}return function(){var a=d(arguments);return c.apply(null,e.concat(a))}}},a.each=a.curry(function(c,d){if(c=e(c),a.exists(d)&&a.isArray(d))for(var f=0;f<d.length;f+=1)if(c.call(null,d[f],f)===b)return}),a.map=a.curry(function(b,c){b=e(b);var d=[];return a.each(function(){d.push(b.apply(null,arguments))},c),d}),a.fold=a.foldl=a.curry(function(b,c,d){return b=e(b),a.each(function(a,d){c=b.call(null,c,a,d)},d),c}),a.reduce=a.reducel=a.foldll=a.curry(function(b,c){b=e(b);var d=c[0];return c.shift(),a.fold(b,d,c)}),a.clone=function(b){var c=[];return a.each(function(a){c.push(a)},b),c},a.first=a.head=a.take=a.curry(function(c,d){c=e(c);var f;return a.each(function(a){return c.call(null,a)?(f=a,b):void 0},d),f}),a.rest=a.tail=a.drop=a.curry(function(b,c){var d=a.select(b,c);return d.shift(),d}),a.last=a.curry(function(b,c){var d=a.clone(c);return a.first(b,d.reverse())}),a.every=a.all=a.curry(function(c,d){c=e(c);var f=!0;return a.each(function(a){return c.call(null,a)?void 0:(f=!1,b)},d),f}),a.any=a.contains=a.curry(function(c,d){c=e(c);var f=!1;return a.each(function(a){return c.call(null,a)?(f=!0,b):void 0},d),f}),a.select=a.filter=a.curry(function(b,c){b=e(b);var d=[];return a.each(function(a){b.call(null,a)&&d.push(a)},c),d}),a.best=a.curry(function(b,c){b=e(b);var d=function(a,c){return b.call(this,a,c)?a:c};return a.reduce(d,c)}),a["while"]=a.curry(function(c,d){c=e(c);var f=[];return a.each(function(a){return c.call(null,a)?void f.push(a):b},d),f}),a.compose=function(b){var c=a.any(function(b){return!a.isFunction(b)});if(b=d(arguments).reverse(),c(b))throw"fjs Error: Invalid function to compose";return function(){var c=arguments,d=a.each(function(a){c=[a.apply(null,c)]});return d(b),c[0]}},a.partition=a.curry(function(b,c){b=e(b);var d=[],f=[];return a.each(function(a){(b.call(null,a)?d:f).push(a)},c),[d,f]}),a.group=a.curry(function(b,c){b=e(b);var d,f={};return a.each(function(a){d=b.call(null,a),f[d]=f[d]||[],f[d].push(a)},c),f}),a.shuffle=function(b){var c,d;return a.each(function(a,e){c=Math.floor(Math.random()*(e+1)),d=b[e],b[e]=b[c],b[c]=d},b),b},a.toArray=function(b){return a.map(function(a){return[a,b[a]]},Object.keys(b))},a.apply=a.curry(function(b,c){var d=[];return a.isArray(b)&&(d=[].slice.call(b,1),b=b[0]),a.map(function(a){return a[b].apply(a,d)},c)}),a.assign=a.extend=a.curry(function(b,c){return a.each(function(a){c[a]=b[a]},Object.keys(b)),c}),a.prop=function(a){return function(b){return b[a]}},a.pluck=a.curry(function(b,c){return a.map(a.prop(b),c)}),a.nub=a.unique=a.distinct=a.curry(function(b,c){var d=c.length>0?[c[0]]:[];return a.each(function(c){a.any(a.curry(b)(c),d)||(d[d.length]=c)},c),d}),a.exists=function(a){return null!=a},a.truthy=function(b){return a.exists(b)&&b!==!1},a.falsy=function(b){return!a.truthy(b)},a.each(function(b){a["is"+b]=function(a){return Object.prototype.toString.call(a)==="[object "+b+"]"}},["Arguments","Date","Number","RegExp","String"]),a}();"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=d),exports.fjs=d),function(a){function c(){for(var a=0;a<x.length;a++)x[a][0](x[a][1]);x=[],q=!1}function d(a,b){x.push([a,b]),q||(q=!0,w(c,0))}function e(a,b){function c(a){h(b,a)}function d(a){j(b,a)}try{a(c,d)}catch(e){d(e)}}function f(a){var b=a.owner,c=b.state_,d=b.data_,e=a[c],f=a.then;if("function"==typeof e){c=t;try{d=e(d)}catch(i){j(f,i)}}g(f,d)||(c===t&&h(f,d),c===u&&j(f,d))}function g(a,b){var c;try{if(a===b)throw new TypeError("A promises callback cannot return that same promise.");if(b&&("function"==typeof b||"object"==typeof b)){var d=b.then;if("function"==typeof d)return d.call(b,function(d){c||(c=!0,b!==d?h(a,d):i(a,d))},function(b){c||(c=!0,j(a,b))}),!0}}catch(e){return c||j(a,e),!0}return!1}function h(a,b){a!==b&&g(a,b)||i(a,b)}function i(a,b){a.state_===r&&(a.state_=s,a.data_=b,d(l,a))}function j(a,b){a.state_===r&&(a.state_=s,a.data_=b,d(m,a))}function k(a){a.then_=a.then_.forEach(f)}function l(a){a.state_=t,k(a)}function m(a){a.state_=u,k(a)}function n(a){if("function"!=typeof a)throw new TypeError("Promise constructor takes a function argument");if(this instanceof n==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],e(a,this)}var o=a.Promise,p=o&&"resolve"in o&&"reject"in o&&"all"in o&&"race"in o&&function(){var a;return new o(function(b){a=b}),"function"==typeof a}();"undefined"!=typeof exports&&exports?exports.Promise=n||o:p||(a.Promise=n);var q,r="pending",s="sealed",t="fulfilled",u="rejected",v=function(){},w="undefined"!=typeof setImmediate?setImmediate:setTimeout,x=[];n.prototype={constructor:n,state_:r,then_:null,data_:b,then:function(a,b){var c={owner:this,then:new this.constructor(v),fulfilled:a,rejected:b};return this.state_===t||this.state_===u?d(f,c):this.then_.push(c),c.then},"catch":function(a){return this.then(null,a)}},n.all=function(a){var b=this;if(!Array.isArray(a))throw new TypeError("You must pass an array to Promise.all().");return new b(function(b,c){function d(a){return g++,function(c){f[a]=c,--g||b(f)}}for(var e,f=[],g=0,h=0;h<a.length;h++)e=a[h],e&&"function"==typeof e.then?e.then(d(h),c):f[h]=e;g||b(f)})},n.race=function(a){var b=this;if(!Array.isArray(a))throw new TypeError("You must pass an array to Promise.race().");return new b(function(b,c){for(var d,e=0;e<a.length;e++)d=a[e],d&&"function"==typeof d.then?d.then(b,c):b(d)})},n.resolve=function(a){var b=this;return a&&"object"==typeof a&&a.constructor===b?a:new b(function(b){b(a)})},n.reject=function(a){var b=this;return new b(function(b,c){c(a)})}}(new Function("return this")()),function(){function a(a){if("string"!=typeof a&&(a=a.toString()),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(a))throw new TypeError("Invalid character in header field name");return a.toLowerCase()}function b(a){return"string"!=typeof a&&(a=a.toString()),a}function c(a){this.map={},a instanceof c?a.forEach(function(a,b){this.append(b,a)},this):a&&Object.getOwnPropertyNames(a).forEach(function(b){this.append(b,a[b])},this)}function d(a){return a.bodyUsed?Promise.reject(new TypeError("Already read")):void(a.bodyUsed=!0)}function e(a){return new Promise(function(b,c){a.onload=function(){b(a.result)},a.onerror=function(){c(a.error)}})}function f(a){var b=new FileReader;return b.readAsArrayBuffer(a),e(b)}function g(a){var b=new FileReader;return b.readAsText(a),e(b)}function h(){return this.bodyUsed=!1,this._initBody=function(a){if(this._bodyInit=a,"string"==typeof a)this._bodyText=a;else if(n.blob&&Blob.prototype.isPrototypeOf(a))this._bodyBlob=a;else if(n.formData&&FormData.prototype.isPrototypeOf(a))this._bodyFormData=a;else{if(a)throw new Error("unsupported BodyInit type");this._bodyText=""}},n.blob?(this.blob=function(){var a=d(this);if(a)return a;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(f)},this.text=function(){var a=d(this);if(a)return a;if(this._bodyBlob)return g(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var a=d(this);return a?a:Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(k)}),this.json=function(){return this.text().then(JSON.parse)},this}function i(a){var b=a.toUpperCase();return o.indexOf(b)>-1?b:a}function j(a,b){if(b=b||{},this.url=a,this.credentials=b.credentials||"omit",this.headers=new c(b.headers),this.method=i(b.method||"GET"),this.mode=b.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&b.body)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(b.body)}function k(a){var b=new FormData;return a.trim().split("&").forEach(function(a){if(a){var c=a.split("="),d=c.shift().replace(/\+/g," "),e=c.join("=").replace(/\+/g," ");b.append(decodeURIComponent(d),decodeURIComponent(e))}}),b}function l(a){var b=new c,d=a.getAllResponseHeaders().trim().split("\n");return d.forEach(function(a){var c=a.trim().split(":"),d=c.shift().trim(),e=c.join(":").trim();b.append(d,e)}),b}function m(a,b){b||(b={}),this._initBody(a),this.type="default",this.url=null,this.status=b.status,this.ok=this.status>=200&&this.status<300,this.statusText=b.statusText,this.headers=b.headers instanceof c?b.headers:new c(b.headers),this.url=b.url||""}if(!self.fetch){c.prototype.append=function(c,d){c=a(c),d=b(d);var e=this.map[c];e||(e=[],this.map[c]=e),e.push(d)},c.prototype["delete"]=function(b){delete this.map[a(b)]},c.prototype.get=function(b){var c=this.map[a(b)];return c?c[0]:null},c.prototype.getAll=function(b){return this.map[a(b)]||[]},c.prototype.has=function(b){return this.map.hasOwnProperty(a(b))},c.prototype.set=function(c,d){this.map[a(c)]=[b(d)]},c.prototype.forEach=function(a,b){Object.getOwnPropertyNames(this.map).forEach(function(c){this.map[c].forEach(function(d){a.call(b,d,c,this)},this)},this)};var n={blob:"FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(a){return!1}}(),formData:"FormData"in self},o=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];h.call(j.prototype),h.call(m.prototype),self.Headers=c,self.Request=j,self.Response=m,self.fetch=function(a,b){var c;return c=j.prototype.isPrototypeOf(a)&&!b?a:new j(a,b),new Promise(function(a,b){function d(){return"responseURL"in e?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):void 0}var e=new XMLHttpRequest;e.onload=function(){var c=1223===e.status?204:e.status;if(100>c||c>599)return void b(new TypeError("Network request failed"));var f={status:c,statusText:e.statusText,headers:l(e),url:d()},g="response"in e?e.response:e.responseText;a(new m(g,f))},e.onerror=function(){b(new TypeError("Network request failed"))},e.open(c.method,c.url,!0),"include"===c.credentials&&(e.withCredentials=!0),"responseType"in e&&n.blob&&(e.responseType="blob"),c.headers.forEach(function(a,b){e.setRequestHeader(b,a)}),e.send("undefined"==typeof c._bodyInit?null:c._bodyInit)})},self.fetch.polyfill=!0}}();var e=function(a){return function(b){return a(),b}},f=function g(b,d){if(this===c.lib)return g.call(a,b,d);d=d||this||a;var e=b.constructor===[].constructor?b:b.split("."),f=e[0],h=d[f];return void 0!==h?e.length>1?g(e.slice(1),h):h:void 0};c.lib={getval:f,tap:e},function(){function a(a){var b=c.lib.getval("location.hostname"),d=(a||"").split(b);return d[1]||"/"}function b(a){var b={},e=(a||c.lib.getval("location.search")).replace("?",""),f=e.split("&");return f=d.filter(function(a){return""!==a},f),d.each(function(a){var c=a.split("=");b[c[0]]=c[1]},f),b}function e(a){var b=a.substring(0,a.lastIndexOf("/"));return c.rest.contextInfo(b).then(function(a){var b=new SP.ClientContext(a.WebFullUrl);return b._info=a,b})}var f=function(a){var b=a.file,c=a.namespace;return new Promise(function(a,d){SP.SOD.registerSod(b,SP.Utilities.Utility.getLayoutsPageUrl(b)),SP.SOD.executeFunc(b,c,a)})},g=function(a){return new Promise(function(b,c){SP.SOD.executeFunc("sp.js","SP.ClientContext",function(){var c=a.map(f);Promise.all(c).then(b)})})};c.helpers={withSharePointDependencies:g,abs2rel:a,clientContext:e,urlQuery:b}}(),function(){function b(a){var b="/_api/contextinfo";return m(a+b).then(function(a){return a.d.GetContextWebInformation})}var g,h=function(){return b().then(function(a){return a.FormDigestValue})},i=function(b){return new Promise(function(c,d){if(g&&b!==!0)c(g);else{var f=a.document.getElementById("__REQUESTDIGEST");null!==f&&"InvalidFormDigest"!==f.value?(g=f.value,c(g)):h().then(e(function(a){g=a})).then(c)}})},j=function(a,b){return new Promise(function(c,e){var f={url:a.indexOf("http")>-1?a:_spPageContextInfo.webAbsoluteUrl+a,method:"GET",credentials:"include",headers:{accept:"application/json;odata=verbose"}};c(d.assign(b||{},f))})},k=function(a,b,c){return Promise.all([j(a),i()]).then(function(a){var e=a[0],g=a[1],h=d.assign(f("headers",c)||{},f("headers",e)||{},{"X-RequestDigest":g}),i={method:"POST",body:b,contentType:"application/json;odata=verbose"},j=d.assign(c||{},i,e);return j.headers=h,j})},l=function(a,b){return a=a||"/",j(a,b).then(function(a){return fetch(a.url,a).then(o)})},m=function(a,b,c){return b="string"==typeof b?b:JSON.stringify(b),k(a,b,c).then(function(b){return fetch(a,b).then(o)})},n=function(a){return a.d.results||a.d},o=function(a){return"function"==typeof a.json?a.json():a};c.rest={get:l,post:m,withRequestDigest:i,unwrapResults:n,contextInfo:b}}(),function(){var b=function(a,b){var d="/_api/Web/Lists/getByTitle('"+a+"')/items/";return c.rest.get(d,b).then(c.rest.unwrapResults)},d=function(a,b,d){var e="/_api/Web/Lists/getByTitle('"+a+"')/items/";return c.rest.post(e,b,d).then(c.rest.unwrapResults)},e=function(a,b,d){var e="/_api/Web/Lists/getByTitle('"+a+"')/items/getbyid("+b+")";return c.rest.get(e,d).then(c.rest.unwrapResults)},f=function(){function b(b,d){var e=c.helpers.clientContext(d);return e.then(function(c){var e=c.get_web(),f=e.getFileByServerRelativeUrl(d.split(a.location.hostname)[1]);return"in"===b?f.checkIn():"out"===b&&f.checkOut(),new Promise(c.executeQueryAsync)})}function d(a){return b("in",a)}function e(a){return b("out",a)}return{checkIn:d,checkOut:e}}();c.list={getListByName:b,postListByName:d,getListItemById:e,files:f}}(),function(){var a=function(a){var b=a.split("|");return b[b.length-1]};c.conversion={getUserNameFromClaim:a}}(),function(){var a=function(a){this.termSet=a,this.getSortOrder=function(){return this.termSet.get_customSortOrder()},this.children={}},b=function(a){this.term=a,this.getName=function(){return this.term.get_name()},this.getUrl=function(){return this.term.get_localCustomProperties()._Sys_Nav_SimpleLinkUrl},this.getSortOrder=function(){return this.term.get_customSortOrder()},this.getIsRoot=function(){return this.term.get_isRoot()},this.getGuid=function(){return this.term.get_id()},this.getLocalCustomProperty=function(a){return this.term.get_localCustomProperties()[a]},this.children={}},e=function(a){for(var b=a.getEnumerator(),c=[];b.moveNext();)c.push(b.get_current());return c},f=function(c){var d=c._termSet,f=new a(d),g=function(a,c,d){var e=d[0];1===d.length?a[e]?a[e].term=c:a[e]=new b(c):(a[e]||(a[e]=new b),g(a[e].children,c,d.slice(1)))};return e(c).forEach(function(a){g(f.children,a,a.get_pathOfTerm().split(";"))}),f},g=function(a){var b=SP.Taxonomy.TaxonomySession.getTaxonomySession(a);return b.getDefaultSiteCollectionTermStore()},h=function(){return c.helpers.withSharePointDependencies([{file:"sp.taxonomy.js",namespace:"SP.Taxonomy"}])},i=function(a){function b(a,b){var d=c.indexOf(a.getGuid()),e=c.indexOf(b.getGuid());return d-e}var c=a.getSortOrder();c?(c=c.split(":"),a.children.sort(b)):a.children.sort()},j=function(a){return i(a),a.children&&d.each(j,a.children),a},k=function(a){return new Promise(function(b,c){h().then(function(){var d=SP.ClientContext.get_current(),e=g(d),f=e.getTermSet(a),h=f.getAllTerms();d.load(h),d.load(f),d.executeQueryAsync(function(){return h._termSet=f,b(h)},c)})})},l=function(a){return k(a).then(e)},m=function(a){return k(a).then(f).then(j)};c.termstore={getTerms:k,getTermsList:l,getTermsTree:m,withTaxonomy:h}}(),function(){var a=function(){window.location.href="/_layouts/closeconnection.aspx?loginasanotheruser=true"},b=function(){window.location.href="/_layouts/closeconnection.aspx"},d=function(){return new Promise(function(a,b){var c=new SP.ClientContext.get_current,d=(c.get_web(),web.get_currentUser());c.load(d),c.executeQueryAsync(function(){a(d)},function(a,c){b(new Error(c.get_message()))})})},e=function(a){var b="/_api/SP.UserProfiles.PeopleManager/GetMyProperties?$select=UserUrl";return c.rest.get(b,a).then(function(a){return a.d.UserUrl})};c.user={loginAsAnotherUser:a,logoutUser:b,getCurrentUser:d,getCurrentUserPersonalSiteUrl:e}}(),function(){var a="/_api/search/postquery",b=function(){return{__metadata:{type:"Microsoft.Office.Server.Search.REST.SearchRequest"}}},e=function(){return{Querytext:"sharepoint",Querytemplate:"{searchterms} Author:johndoe",EnableInterleaving:"True",SourceId:"8413cd39-2156-4e00-b54d-11efd9abdb89",RankingModelId:"CustomRankingModelID",StartRow:"10",RowLimit:"30",RowsPerPage:"10",SelectProperties:{results:["Title","Author"]},Culture:"1044",RefinementFilters:{results:['fileExtension:equals("docx")']},Refiners:{results:["author,size"]},HiddenConstraints:"developer",SortList:{results:[{Property:"Created",Direction:"0"},{Property:"FileExtension",Direction:"1"}]},EnableStemming:"False",TrimDuplicates:"False",Timeout:"60000",EnableNicknames:"True",EnablePhonetic:"True",EnableFQL:"True",BypassResultTypes:"true",ProcessBestBets:"true",ClientType:"custom",PersonalizationData:"<GUID>",ResultURL:"http://server/site/resultspage.aspx",QueryTag:"tag1;tag2",Properties:{results:[{Name:"sampleBooleanProperty",Value:{BoolVal:"True",QueryPropertyValueTypeIndex:3}},{Name:"sampleIntProperty",Value:{IntVal:"1234",QueryPropertyValueTypeIndex:2}}]},EnableQueryRules:"False",ReorderingRules:{results:[{MatchValue:"<someValue>",Boost:"10",MatchType:"0"}]},ProcessPersonalFavorites:"false",QueryTemplatePropertiesUrl:"spfile://webroot/queryparametertemplate.xml",HitHighlihtedMultivaluePropertyLimit:"2",CollapseSpecification:"Author:1 ContentType:2",EnableSorting:"false",GenerateBlockRankLog:"true",UILanguage:"1044",DesiredSnippetLength:"80",MaxSnippetLength:"100",Summarylength:"150"}},f=function(e,f){return c.rest.post((f||_spPageContextInfo.siteServerRelativeUrl)+a,d.assign(e,b()))};c.search={searchCfgExample:e,postSearch:f}}(),c.fjs=d}(window)}$_global_sputils();